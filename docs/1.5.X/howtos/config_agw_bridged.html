<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>AGW Bridged Mode · Magma Documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="# Magma AGW Bridged mode"/><meta name="docsearch:version" content="1.5.X"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="AGW Bridged Mode · Magma Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://magma.github.io/magma/"/><meta property="og:description" content="# Magma AGW Bridged mode"/><meta property="og:image" content="https://magma.github.io/magma/img/docusaurus.png"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://magma.github.io/magma/img/docusaurus.png"/><link rel="shortcut icon" href="/magma/img/icon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script><script type="text/javascript" src="/init.js"></script><script src="/magma/js/scrollSpy.js"></script><link rel="stylesheet" href="/magma/css/main.css"/><script src="/magma/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/magma/"><img class="logo" src="/magma/img/magma-logo.svg" alt="Magma Documentation"/><h2 class="headerTitleWithLogo">Magma Documentation</h2></a><a href="/magma/versions"><h3>1.5.X</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://magmacore.org" target="_self">Magma Website</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="/magma/" target="_self">Docs</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://github.com/magma" target="_self">Code</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://github.com/magma/magma/wiki/Contributor-Guide" target="_self">Contributing</a></li><li class=""><a target="_self"> | </a></li><li class=""><a href="https://wiki.magmacore.org/" target="_self">Wiki</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>How-To</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Getting Started<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/basics/introduction">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/basics/prerequisites">Prerequisites</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/basics/quick_start_guide">Quick Start Guide</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Usage<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">How-To</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/ue_metering">UE Usage Metering</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/magma/docs/1.5.X/howtos/config_agw_bridged">AGW Bridged Mode</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/call_tracing">Call Tracing</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/events_monitoring">Events Monitoring</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/inbound_roaming">Inbound Roaming</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/thanos">Thanos</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">NMS</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/dashboard">Dashboard</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/equipment">Equipment</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/network">Network</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/subscriber">Subscriber</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/traffic">Traffic</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/metrics">Metrics</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/alerts">Alerts</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/tips_and_tricks">Tips and Tricks</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Troubleshooting</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/troubleshooting/agw_unable_to_checkin">Access Gateway Unable to Check-in to Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/troubleshooting/user_unable_to_attach">User is unable to attach to Magma</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/troubleshooting/update_certificates">Update rootCA and controller SSL certificates</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/troubleshooting/generate_admin_operator_certificates">Generate and update admin_operator certificates</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/howtos/troubleshooting/analyze_service_crashes_in_agw">Analyze Service crashes in AGW</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Architecture<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/architecture_overview">Overview</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/architecture_overview">Overview</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/architecture_modularity">Modularity</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/architecture_security">Security</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">NMS</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/architecture_overview">Overview</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Deploy<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/deploy_install">Install AGW</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/deploy_install_ubuntu">Install AGW on Ubuntu 20.04</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/deploy_config_agw">Configure AGW</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/deploy_config_enodebd">Configure eNodeB</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/deploy_config_apn">Configure an APN</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/deploy_config_agw_ha">Configure AGW for HA</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/build_install_magma_pkg_in_agw">Build and install a magma package in AGW</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/deploy_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/deploy_build">Build Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/deploy_install">Install Orchestrator</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/hold_terraform_state_on_s3">Hold Terraform state outside my local machine</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/override_values_of_terraform_files">Override values of Terraform files</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/deploy_orcl">Experimental Orc8r Deployer</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/deploy_faq">FAQs</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">NMS</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/deploy_config">Configure NMS</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Federation Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/feg/deploy_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/feg/deploy_build">Build FeG</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/feg/deploy_install">Install FeG</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/feg/deploy_configure">Configure FeG</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Upgrade<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/upgrade_1_5">Upgrade to v1.5</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/upgrade_1_4">Upgrade to v1.4</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/upgrade_1_3">Upgrade to v1.3</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/upgrade_1_2">Upgrade to v1.2</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/upgrade_1_1">Upgrade to v1.1</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/upgrade_intro">Introduction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/upgrade_1_5">Upgrade to v1.5</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/upgrade_1_4">Upgrade to v1.4</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/upgrade_1_3">Upgrade to v1.3</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/upgrade_1_2">Upgrade to v1.2</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/upgrade_1_1">Upgrade to v1.1</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Debug<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/debug_show_tech">Show Tech</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/debug_dp_probe">Datapath Probe CLI</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/debug_logs">View Logs</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Contribute<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/contributing/contribute_onboarding">Developer Onboarding</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/contributing/contribute_workflow">Development Workflow</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/contributing/contribute_conventions">Contributing Conventions</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/contributing/contribute_ci_checks">Continuous Integration Checks</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/contributing/contribute_codeowners">Codeowners Workflow</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Technical Reference<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Access Gateway</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/dev_notes">Developer Notes</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/dev_unit_testing">Unit Testing</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/tr069">Add eNB TR-069 Support</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/s1ap_tests">S1AP Integration Tests</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/eventd">Event Reporting</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/lte/access_service_restrictions">Restricting Network Access</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">Orchestrator</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/dev_testing">Testing Tips</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/dev_minikube">Deploy on Minikube</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/dev_security">Security</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/dev_indexers">State Indexers</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/orc8r/dev_dependencies">Module Dependencies</a></li></ul></div><div class="navGroup subNavGroup"><h4 class="navGroupSubcategoryTitle">NMS</h4><ul><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/dev_spacing">Spacing Guidelines</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/dev_themes">Themes</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/nms/dev_components">Components</a></li></ul></div></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Proposals<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p001_vpn_config_from_api">Configurable VPN from Orchestrator API</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p002_scaled_prometheus_pipeline">Scaled Prometheus Pipeline</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p003_qos_enforcement">QoS Policy Configuration</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p004_fua_restrict_feature">Service Restriction Feature</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p005_call_tracing">Call Tracing for Troubleshooting</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p007_header_enrichment">Header enrichment</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p008_apn_correction">MME APN Correction</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p009_nms_mariadb_migration">NMS MariaDB Migration</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p010_subscriber_scaling">Subscriber Scaling</a></li><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/proposals/p011_victoriametrics">VictoriaMetrics as Magma&#x27;s TSDB</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">FAQ<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/magma/docs/1.5.X/faq/faq_magma">Frequently Asked Questions</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"></header><article><div><span><h1><a class="anchor" aria-hidden="true" id="magma-agw-bridged-mode"></a><a href="#magma-agw-bridged-mode" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Magma AGW Bridged mode</h1>
<p>Bridged mode on the Access Gateway refers to any IP allocation strategy that
does not NAT assigned UE IP addresses at the AGW.</p>
<p>There are 3 components to reconfigure to enable bridged mode:</p>
<ul>
<li>Bridged (Non-NAT) config option for AGW</li>
<li>UE IP allocation mode</li>
<li>AGW management plane traffic</li>
</ul>
<p>This document will explain how to configure these options using the
Orchestrator API. You can also use the JSON editor components on the NMS to
update these values if you don't have access to the API. Navigate to the
corresponding component on the NMS (e.g. gateway, network, subscriber) and
use the JSON editor to edit its configuration.</p>
<h2><a class="anchor" aria-hidden="true" id="enable-bridged-mode"></a><a href="#enable-bridged-mode" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Enable Bridged Mode</h2>
<p>To configure an AGW in bridged mode, you need to disable NAT on the AGW.
Note that this is a gateway-level configuration, so you will need to change
this for every AGW in the network that you want to run in bridged mode.</p>
<pre><code class="hljs">API: <span class="hljs-string">/lte/</span>{network_id}<span class="hljs-string">/gateways/</span>{gateway_id}<span class="hljs-string">/cellular</span>
{
  <span class="hljs-string">"epc"</span>: {
    <span class="hljs-string">...</span>
    <span class="hljs-string">"nat_enabled"</span>: <span class="hljs-literal">false</span>
  },
</code></pre>
<p>This mode will turn on the <code>uplink_br0</code> interface in the AGW to bridge UE
traffic to the SGi interface. You will need to configure an internet gateway
node that handles NAT and routing for all user plane traffic. The AGW will
detect the (default) internet gateway from its networking stack and start ARP
probes to get the gateway MAC address. This gateway MAC address is used as the
target host for all bridged user plane traffic. If the AGW is not able complete
ARP resolution, it floods user plane packets in SGi L2 segment. To avoid
flooding SGi network, you can statically set the fallback MAC address of the
internet gateway in <code>/var/opt/magma/configs/pipelined.yml</code> with the key
<code>uplink_gw_mac</code>.</p>
<p>When switching between NAT modes, we recommend rebooting the AGW. You can do
this from the NMS or manually if you have direct access to your AGW.</p>
<h2><a class="anchor" aria-hidden="true" id="ue-ip-address-allocation"></a><a href="#ue-ip-address-allocation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>UE IP Address Allocation</h2>
<p>How you choose to allocate IP addresses to your UEs will heavily depend on SGi
network design and integration with the rest of your LTE system. On UE attach,
the PGW component of the AGW allocates an IP address for the UE. We currently
support the following IP allocation options:</p>
<ul>
<li>IP Pool</li>
<li>DHCP</li>
<li>Static Assigned IP address</li>
<li>Multi APN: Separate address space per APN</li>
</ul>
<p>The first two modes are basic IP allocation algorithms, and the next two are
add-ons. The most straightforward (and default) configuration is to assign
an IP pool for the AGW to assign UE IPs from.</p>
<p>The first step in IP address allocation is to configure mobility parameters on
Orchestrator. This is a network-wide configuration, so any mobility options
you configure will be passed down to all AGWs in that network.</p>
<h3><a class="anchor" aria-hidden="true" id="ip-pool"></a><a href="#ip-pool" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>IP Pool</h3>
<p>This is the default configuration for new AGWs. We call this &quot;NAT&quot; mode on the
API.</p>
<pre><code class="hljs">API: /lte/{network_id}/cellular
{
  <span class="hljs-string">"epc"</span>: {
    <span class="hljs-built_in">..</span><span class="hljs-built_in">..</span>
    <span class="hljs-string">"mobility"</span>: {
      <span class="hljs-built_in">..</span><span class="hljs-built_in">..</span>
      <span class="hljs-string">"ip_allocation_mode"</span>: <span class="hljs-string">"NAT"</span>,
      <span class="hljs-string">"nat"</span>: {
        <span class="hljs-string">"ip_blocks"</span>: [
          <span class="hljs-string">"192.168.0.0/16"</span>
        ]
      },
      <span class="hljs-built_in">..</span><span class="hljs-built_in">..</span>
</code></pre>
<p>In this case, the AGW allocates IP addresses from the configured IP block on a
first-come-first-served basis.</p>
<h3><a class="anchor" aria-hidden="true" id="dhcp"></a><a href="#dhcp" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>DHCP</h3>
<p>NOTE: This feature requires installed <code>libpcap</code>.</p>
<p>To enable this feature, set <code>ip_allocation_mode</code> to <code>DHCP_BROADCAST</code>.</p>
<pre><code class="hljs">API: /lte/{network_id}/cellular
{
  <span class="hljs-string">"epc"</span>: {
    <span class="hljs-built_in">..</span><span class="hljs-built_in">..</span>
    <span class="hljs-string">"mobility"</span>: {
      <span class="hljs-built_in">..</span><span class="hljs-built_in">..</span>
      <span class="hljs-string">"ip_allocation_mode"</span>: <span class="hljs-string">"DHCP_BROADCAST"</span>,
      <span class="hljs-built_in">..</span><span class="hljs-built_in">..</span>
</code></pre>
<p>In this mode, the AGW will generate a DHCP request packet on each UE attach
event. The MAC address for the DHCP request will be deterministically generated
from the UE's IMSI. This DHCP request packet is sent over the SGi network.
After receiving the corresponding DHCP lease, <code>mobilityd</code> service on the AGW
will parse the packet and complete the attach procedure.</p>
<h3><a class="anchor" aria-hidden="true" id="static-ip-assignments"></a><a href="#static-ip-assignments" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Static IP Assignments</h3>
<p>You can also assign a specific IP address to any UE for an APN session on the
subscriber entity. If static IP assignments are enabled but a UE does not have
an assigned IP, the AGW will fall back to the network-wide IP allocation
strategy.</p>
<p>To enable this feature, first set the appropriate feature flag on the network:</p>
<pre><code class="hljs">API: <span class="hljs-string">/lte/</span>{network_id}<span class="hljs-string">/cellular</span>
{
  <span class="hljs-string">"epc"</span>: {
    <span class="hljs-string">....</span>
    <span class="hljs-string">"mobility"</span>: {
      <span class="hljs-string">"enable_static_ip_assignments"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">....</span>
</code></pre>
<p>After this, you can assign a static IP for a specific APN for any registered
subscriber.</p>
<pre><code class="hljs"><span class="hljs-symbol">API:</span> <span class="hljs-meta-keyword">/lte/</span>{network_id}/subscribers
<span class="hljs-string">"static_ips"</span>: {
    <span class="hljs-string">"active_apn_name"</span>: <span class="hljs-string">"192.168.100.1"</span>,
  }
</code></pre>
<p>Note you can only assign a static IP to an active APN (i.e. provision the
corresponding APN first). The Static IP cannot overlap with the configured
IP block for pool (NAT) allocation or the DHCP server subnet.
If you need to change IP that a UE is currently using, first detach the UE
(you can set the subscriber's status to INACTIVE), update the IP configuration,
then re-attach the subscriber (set status back to ACTIVE).</p>
<h3><a class="anchor" aria-hidden="true" id="experimental-multi-apn-ip-allocation"></a><a href="#experimental-multi-apn-ip-allocation" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Experimental: Multi-APN IP Allocation</h3>
<p>NOTE: This is currently an experimental feature.</p>
<p>Like static IP assignments, this is gated behind a network-wide feature flag:</p>
<pre><code class="hljs">API: <span class="hljs-string">/lte/</span>{network_id}<span class="hljs-string">/cellular</span>
{
  <span class="hljs-string">"epc"</span>: {
    <span class="hljs-string">....</span>
    <span class="hljs-string">"mobility"</span>: {
      <span class="hljs-string">"enable_multi_apn_ip_allocation"</span>: <span class="hljs-literal">true</span>,
      <span class="hljs-string">....</span>
</code></pre>
<p>Multi APN IP address assignment today is limited to DHCP based IP assignment.
You will needs set up a different VLAN network for each APN. SGi port needs to
be a trunk port so that it can access the VLAN nework associated with each APN.
Along with VLAN, you can also define Gateway IP address and Gateway MAC address
for UE traffic to be programmed by the AGW in the UE's datapath.</p>
<p>If the internet gateway IP address is not specified, it is parsed from the DHCP
response for the UE IP address allocation. If the internet gateway MAC address
is not specified, the AGW will ARP the Gateway IP address in the respective
VLAN. Your internet gateway needs to respond to this broadcast ARP
(i.e. source IP is <code>0.0.0.0</code>) from the AGW. In the event of a missing internet
gateway IP address or failure to resolve ARP, the AGW will flood all UE packets
on the respective L2 segment using the <code>ff:ff:ff:ff:ff:ff</code> MAC address.</p>
<p>These configuration options are specified at the AGW level per APN:</p>
<pre><code class="hljs"><span class="hljs-symbol">API:</span> <span class="hljs-meta-keyword">/lte/</span>{network_id}<span class="hljs-meta-keyword">/gateways/</span>{gateway_id}
  <span class="hljs-string">"apn_resources"</span>: {
    <span class="hljs-string">"inet"</span>: {
      <span class="hljs-string">"apn_name"</span>: <span class="hljs-string">"inet"</span>,
      <span class="hljs-string">"gateway_ip"</span>: <span class="hljs-string">"internet_gateway_host_ip"</span>,
      <span class="hljs-string">"gateway_mac"</span>: <span class="hljs-string">"internet_gateway_host_mac"</span>,
      <span class="hljs-string">"id"</span>: <span class="hljs-string">"id_of_this_apn_resource"</span>,
      <span class="hljs-string">"vlan_id"</span>: <span class="hljs-number">0</span>
    },

</code></pre>
<p>There is an option to statically configure the internet gateway MAC address for
an AGW if you're using an identical uplink network for all APNs.
In <code>/var/opt/magma/configs/pipelined.yml</code>, set the key <code>uplink_gw_mac</code>
to the MAC address of your internet gateway. This value will be used as a
fallback if all other methods of determining the MAC of the uplink internet
gateway have failed.</p>
<h2><a class="anchor" aria-hidden="true" id="agw-management-traffic"></a><a href="#agw-management-traffic" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>AGW Management Traffic</h2>
<p>Magma allows to SGi inteface to act as management interface.
By default SGi interface would start DHCP client on the port.
In NATed mode this sets this IP address to SGi interface.
This sets IP address on SGi eth port in NATed mode. In bridged mode
this IP is set to Bridge interface.</p>
<p>There is orc8r API to assign static IP and default Gateway for each AGW.</p>
<pre><code class="hljs">API: <span class="hljs-string">/lte/</span>{network_id}<span class="hljs-string">/gateways/</span>{gateway_id}<span class="hljs-string">/cellular</span>
{
  <span class="hljs-string">"epc"</span>: {
    <span class="hljs-string">...</span>
    <span class="hljs-string">"sgi_management_iface_static_ip"</span>: <span class="hljs-string">"1.1.1.2/24"</span>,
    <span class="hljs-string">"sgi_management_iface_gw"</span>: <span class="hljs-string">"1.1.1.1"</span>
    <span class="hljs-string">...</span>
  },
</code></pre>
<p>You can also set VLAN for SGi management port using following orc8r.
This only works in Bridged mode.</p>
<pre><code class="hljs">API: <span class="hljs-string">/lte/</span>{network_id}<span class="hljs-string">/gateways/</span>{gateway_id}<span class="hljs-string">/cellular</span>
{
  <span class="hljs-string">"epc"</span>: {
    <span class="hljs-string">...</span>
    <span class="hljs-string">"sgi_management_iface_vlan"</span>: <span class="hljs-string">"100"</span>
    <span class="hljs-string">...</span>
  },
</code></pre>
<p>If you set VLAN in default mode, AGW could send DHCP requests in this VLAN.</p>
<p>When NAT mode is changed, SGi interface is added to AGW bridge and IP address
from SGi port is removed. After this, AGW (without
<code>sgi_management_iface_static_ip</code> config) requests DHCP ip address for the
bridge interface. This could result in IP address change when AGW NAT mode is
changed. You can avoid it by statically assigning IP via API or DHCP.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/magma/docs/1.5.X/howtos/ue_metering"><span class="arrow-prev">← </span><span>UE Usage Metering</span></a><a class="docs-next button" href="/magma/docs/1.5.X/howtos/call_tracing"><span>Call Tracing</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#enable-bridged-mode">Enable Bridged Mode</a></li><li><a href="#ue-ip-address-allocation">UE IP Address Allocation</a><ul class="toc-headings"><li><a href="#ip-pool">IP Pool</a></li><li><a href="#dhcp">DHCP</a></li><li><a href="#static-ip-assignments">Static IP Assignments</a></li><li><a href="#experimental-multi-apn-ip-allocation">Experimental: Multi-APN IP Allocation</a></li></ul></li><li><a href="#agw-management-traffic">AGW Management Traffic</a></li></ul></nav></div><footer class="nav-footer" id="footer"><section class="copyright">Copyright © 2025 The Magma Authors</section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: 'f95caeb7bc059b294eec88e340e5445b',
                indexName: 'magma',
                inputSelector: '#search_input_react'
              });
            </script></body></html>